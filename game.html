<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arbeidskrav 1!</title>
    <link rel="stylesheet" href="game.css" />
  </head>
  <!-- HTML code must not be changed -->

  <body>
    <div class="main-container">
      <!-- healthbar for hereos -->
      <div class="hero-health-containers">
        <div class="healthbar-container">
          <!--healer healthbar must be changed to change health -->
          <div class="healthbar healer-health"></div>
          <div class="text-container">
            <p id="healer-name-txt">Healerens navn</p>
            <p id="healer-health-txt">400 / 400 HP</p>
          </div>
        </div>
        <div class="healthbar-container">
          <!-- archer healthbar must be changed to change health -->
          <div class="healthbar archer-health"></div>
          <div class="text-container">
            <p id="archer-name-txt">Archerens navn</p>
            <p id="archer-health-txt">600 / 600 HP</p>
          </div>
        </div>
        <div class="healthbar-container">
          <!-- Warrior healthbar must be changed to change its health -->
          <div class="healthbar warrior-health"></div>
          <div class="text-container">
            <p id="warrior-name-txt">Warriorens navn</p>
            <p id="warrior-health-txt">800 / 800 HP</p>
          </div>
        </div>
      </div>

      <!-- Healthbar for enemy -->
      <div class="dragon-health-container">
        <div class="healthbar-container">
          <!-- Dragons healthbar must be changed for it to change health -->
          <div class="healthbar dragon-health"></div>
          <div class="text-container">
            <p id="dragon-name-txt">Dragens navn</p>
            <div class="text-container dragon-health-txt">2000 / 2000 HP</div>
          </div>
        </div>
      </div>

      <!-- Image container for hero -->
      <div class="img-container healer">
        <img class="hero" src="assets/healer.png" />
      </div>
      <div class="img-container archer">
        <img class="hero" src="assets/archer.png" />
      </div>
      <div class="img-container warrior">
        <img class="hero" src="assets/warrior.png" />
      </div>

      <!-- Image container for enemy -->
      <div class="enemy-container">
        <div class="img-container dragon-container">
          <img class="dragon" src="assets/dragon.png" />
        </div>
      </div>
    </div>
    <script>
      //Stats for heroes
      let heroesArray = [
        {
          id: 0,
          name: "Henriette Healer",
          maxHP: 400,
          currentHP: 400,
          damage: 100,
          alive: true,
        },
        {
          id: 1,
          name: "Ariana archer",
          maxHP: 500,
          currentHP: 500,
          damage: 400,
          alive: true,
        },
        {
          id: 2,
          name: "Wyona Warrior",
          maxHP: 600,
          currentHP: 600,
          damage: 400,
          alive: true,
        },
      ];

      let dragonObject = {
        name: "Daar Dragon",
        maxHP: 2000,
        currentHP: 2000,
        damage: 200,
        alive: true,
      };

      document.addEventListener("DOMContentLoaded", function () {
        // Get the healer image element
        const healerImg = document.querySelector(".img-container.healer img");

        // Get elements for health bars and texts
        const dragonHealthBar = document.querySelector(".dragon-health");
        const healerHealthBar = document.querySelector(".healer-health");
        const archerHealthBar = document.querySelector(".archer-health");
        const warriorHealthBar = document.querySelector(".warrior-health");
        const dragonHealthTxt = document.querySelector(".dragon-health-txt");
        const healerHealthTxt = document.getElementById("healer-health-txt");
        const archerHealthTxt = document.getElementById("archer-health-txt");
        const warriorHealthTxt = document.getElementById("warrior-health-txt");

        // Add click event listener for the healer
        healerImg.addEventListener("click", function () {
          // Handle Henriette Healer's action
          if (heroesArray[0].alive && dragonObject.alive) {
            // Deal damage to the dragon
            dragonObject.currentHP -= heroesArray[0].damage;

            // Limit healing to 100 HP and only heal alive heroes
            heroesArray.forEach((hero) => {
              if (hero.alive) {
                const healAmount = Math.min(100, hero.maxHP - hero.currentHP);
                hero.currentHP += healAmount;
              }
            });

            // Update health bars and texts
            dragonHealthBar.style.width = `${
              (dragonObject.currentHP / dragonObject.maxHP) * 100
            }%`;

            function SetHealthBar(hero, bar) {
              var healerLife = hero.currentHP / hero.maxHP;
              var heroPixels = healerLife * 300;
              console.log("healer: " + healerLife);
              bar.style.width = `${heroPixels}px`;
            }

            SetHealthBar(heroesArray[0], healerHealthBar);
            SetHealthBar(heroesArray[1], archerHealthBar);
            warriorHealthBar.style.width = `${
              (heroesArray[2].currentHP / heroesArray[2].maxHP) * 100
            }%`;

            // Update health texts
            dragonHealthTxt.innerText = `${dragonObject.currentHP} / ${dragonObject.maxHP} HP`;
            healerHealthTxt.innerText = `${heroesArray[0].currentHP} / ${heroesArray[0].maxHP} HP`;
            archerHealthTxt.innerText = `${heroesArray[1].currentHP} / ${heroesArray[1].maxHP} HP`;
            warriorHealthTxt.innerText = `${heroesArray[2].currentHP} / ${heroesArray[2].maxHP} HP`;

            // Check game status
            // Function to check and display game status
            function checkGameStatus() {
              const resultDiv = document.createElement("div");
              const heading = document.createElement("h1");

              if (!dragonObject.alive) {
                heading.innerText = "Congratulations! You defeated the dragon!";
                resultDiv.className = "game-won";
              } else if (!heroesArray.some((hero) => hero.alive)) {
                heading.innerText = "Game Over! All heroes are defeated.";
                resultDiv.className = "game-lost";
              } else {
                // Game is still ongoing
                return;
              }

              // Append the result to the main container
              document.querySelector(".main-container").appendChild(resultDiv);
              resultDiv.appendChild(heading);
            }
          }
        });
      });
    </script>
  </body>
</html>
